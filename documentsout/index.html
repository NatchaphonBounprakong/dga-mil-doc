<!DOCTYPE html>
<html lang="en" data-textdirection="ltr">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- <meta http-equiv="X-UA-Compatible" content="IE=edge"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <!-- <meta name="description"
        content="Stack admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities.">
    <meta name="keywords"
        content="admin template, stack admin template, dashboard template, flat admin template, responsive admin template, web app">
    <meta name="author" content="PIXINVENT"> -->
    <title>MIL-DOC</title>
    <link rel="apple-touch-icon" href="/mil-doc/images/logo.png">
    <link rel="shortcut icon" type="image/x-icon" href="/mil-doc/images/logo.ico">

    <link href="https://fonts.googleapis.com/css?family=Sarabun&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/mil-doc/css/vendors.css" />
    <link rel="stylesheet" href="/mil-doc/css/app.css" />
    <link rel="stylesheet" href="/mil-doc/css/core/menu/menu-types/vertical-menu.css" />
    <link rel="stylesheet" type="text/css" href="/mil-doc/fonts/simple-line-icons/style.min.css">


    <!-- <link rel="stylesheet" type="text/css" href="/mil-doc/vendors/css/extensions/sweetalert.css">
    <link rel="stylesheet" type="text/css" href="/mil-doc/vendors/css/extensions/unslider.css">
    <link rel="stylesheet" type="text/css" href="/mil-doc/vendors/css/weather-icons/climacons.min.css">
    <link rel="stylesheet" type="text/css" href="/mil-doc/fonts/meteocons/style.css">
    <link rel="stylesheet" type="text/css" href="/mil-doc/vendors/css/charts/morris.css">
    <link rel="stylesheet" type="text/css" href="/mil-doc/css/core/colors/palette-gradient.css">
    <link rel="stylesheet" type="text/css" href="/mil-doc/css/core/colors/palette-gradient.css">
    <link rel="stylesheet" type="text/css" href="/mil-doc/css/pages/timeline.css">
    <link rel="stylesheet" type="text/css" href="/mil-doc/vendors/css/forms/selects/select2.min.css">
    <link rel="stylesheet" type="text/css" href="/mil-doc/css/plugins/forms/wizard.css"> -->
    <!-- <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

</head>

<body class="vertical-layout vertical-menu 2-columns   menu-expanded fixed-navbar" data-open="click"
    data-menu="vertical-menu" data-col="2-columns">

    <!-- fixed-top-->
    <nav class="header-navbar navbar-expand-md navbar navbar-with-menu fixed-top navbar-semi-dark navbar-shadow">
        <div class="navbar-wrapper">
            <div class="navbar-header">
                <ul class="nav navbar-nav flex-row">
                    <li class="nav-item mobile-menu d-md-none mr-auto">
                        <a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#">
                            <i class="ft-menu font-large-1"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="navbar-brand" href="">
                            <img class="brand-logo" alt="MIL-DOC-Logo" src="/mil-doc/images/logo.png" width="25">
                            <h2 class="brand-text">Mil-Doc</h2>
                        </a>
                    </li>
                    <li class="nav-item d-md-none">
                        <a class="nav-link open-navbar-container" data-toggle="collapse" data-target="#navbar-mobile">
                            <i class="fa fa-ellipsis-v"></i>
                        </a>
                    </li>
                    <li class="nav-item d-none mobile-menu d-md-block nav-toggle">
                        <a class="nav-link modern-nav-toggle pr-0" data-toggle="collapse">
                            <i class="toggle-icon ft-toggle-right font-medium-3 white" data-ticon="ft-toggle-right"></i>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="navbar-container content mr-auto">
                <div class="collapse navbar-collapse" id="navbar-mobile">
                    <ul class="nav navbar-nav mr-auto float-left">
                        <li class="nav-item d-none d-md-block">
                            <a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#">
                                <i class="ft-menu"></i>
                            </a>
                        </li>
                        <li class="nav-item d-none d-md-block">
                            <a class="nav-link nav-link-expand" href="#">
                                <i class="ficon ft-maximize"></i>
                            </a>
                        </li>
                        <li class="nav-item nav-search">
                            <a class="nav-link nav-link-search" href="#">
                                <i class="ficon ft-search"></i>
                            </a>
                            <div class="search-input">
                                <input class="input" type="text" placeholder="ค้นหาหนังสือราชการจากเรื่อง....">
                            </div>
                        </li>
                    </ul>
                    <ul class="nav navbar-nav float-right">
                        <li class="dropdown dropdown-notification nav-item"><a class="nav-link nav-link-label" href="#"
                                data-toggle="dropdown"><i class="ficon ft-bell"></i><span
                                    class="badge badge-pill badge-default badge-danger badge-default badge-up">5</span></a>
                            <ul class="dropdown-menu dropdown-menu-media dropdown-menu-right">
                                <li class="dropdown-menu-header">
                                    <h6 class="dropdown-header m-0"><span
                                            class="grey darken-2">Notifications</span><span
                                            class="notification-tag badge badge-default badge-danger float-right m-0">5
                                            New</span></h6>
                                </li>
                                <li class="scrollable-container media-list">
                                    <a href="javascript:void(0)">
                                        <div class="media">
                                            <div class="media-left align-self-center"><i
                                                    class="ft-plus-square icon-bg-circle bg-cyan"></i></div>
                                            <div class="media-body">
                                                <h6 class="media-heading">You have new order!</h6>
                                                <p class="notification-text font-small-3 text-muted">Lorem ipsum dolor
                                                    sit amet, consectetuer elit.</p><small>
                                                    <time class="media-meta text-muted"
                                                        datetime="2015-06-11T18:29:20+08:00">30 minutes
                                                        ago</time></small>
                                            </div>
                                        </div>
                                    </a>
                                    <a href="javascript:void(0)">
                                        <div class="media">
                                            <div class="media-left align-self-center"><i
                                                    class="ft-download-cloud icon-bg-circle bg-red bg-darken-1"></i>
                                            </div>
                                            <div class="media-body">
                                                <h6 class="media-heading red darken-1">99% Server load</h6>
                                                <p class="notification-text font-small-3 text-muted">Aliquam tincidunt
                                                    mauris eu risus.</p><small>
                                                    <time class="media-meta text-muted"
                                                        datetime="2015-06-11T18:29:20+08:00">Five hour
                                                        ago</time></small>
                                            </div>
                                        </div>
                                    </a>
                                    <a href="javascript:void(0)">
                                        <div class="media">
                                            <div class="media-left align-self-center"><i
                                                    class="ft-alert-triangle icon-bg-circle bg-yellow bg-darken-3"></i>
                                            </div>
                                            <div class="media-body">
                                                <h6 class="media-heading yellow darken-3">Warning notifixation</h6>
                                                <p class="notification-text font-small-3 text-muted">Vestibulum auctor
                                                    dapibus neque.</p><small>
                                                    <time class="media-meta text-muted"
                                                        datetime="2015-06-11T18:29:20+08:00">Today</time></small>
                                            </div>
                                        </div>
                                    </a>
                                    <a href="javascript:void(0)">
                                        <div class="media">
                                            <div class="media-left align-self-center"><i
                                                    class="ft-check-circle icon-bg-circle bg-cyan"></i></div>
                                            <div class="media-body">
                                                <h6 class="media-heading">Complete the task</h6><small>
                                                    <time class="media-meta text-muted"
                                                        datetime="2015-06-11T18:29:20+08:00">Last week</time></small>
                                            </div>
                                        </div>
                                    </a>
                                    <a href="javascript:void(0)">
                                        <div class="media">
                                            <div class="media-left align-self-center"><i
                                                    class="ft-file icon-bg-circle bg-teal"></i></div>
                                            <div class="media-body">
                                                <h6 class="media-heading">Generate monthly report</h6><small>
                                                    <time class="media-meta text-muted"
                                                        datetime="2015-06-11T18:29:20+08:00">Last month</time></small>
                                            </div>
                                        </div>
                                    </a>
                                </li>
                                <li class="dropdown-menu-footer"><a class="dropdown-item text-muted text-center"
                                        href="javascript:void(0)">Read all notifications</a></li>
                            </ul>
                        </li>
                        <li class="dropdown dropdown-notification nav-item"><a class="nav-link nav-link-label" href="#"
                                data-toggle="dropdown"><i class="ficon ft-mail"></i><span
                                    class="badge badge-pill badge-default badge-warning badge-default badge-up">3</span></a>
                            <ul class="dropdown-menu dropdown-menu-media dropdown-menu-right">
                                <li class="dropdown-menu-header">
                                    <h6 class="dropdown-header m-0"><span class="grey darken-2">Messages</span><span
                                            class="notification-tag badge badge-default badge-warning float-right m-0">4
                                            New</span></h6>
                                </li>
                                <li class="scrollable-container media-list">
                                    <a href="javascript:void(0)">
                                        <div class="media">
                                            <div class="media-left"><span
                                                    class="avatar avatar-sm avatar-online rounded-circle"><img
                                                        src="/mil-doc/images/portrait/small/avatar-s-1.png"
                                                        alt="avatar"><i></i></span></div>
                                            <div class="media-body">
                                                <h6 class="media-heading">Margaret Govan</h6>
                                                <p class="notification-text font-small-3 text-muted">I like your
                                                    portfolio, let's start.</p><small>
                                                    <time class="media-meta text-muted"
                                                        datetime="2015-06-11T18:29:20+08:00">Today</time></small>
                                            </div>
                                        </div>
                                    </a>
                                    <a href="javascript:void(0)">
                                        <div class="media">
                                            <div class="media-left"><span
                                                    class="avatar avatar-sm avatar-busy rounded-circle"><img
                                                        src="/mil-doc/images/portrait/small/avatar-s-2.png"
                                                        alt="avatar"><i></i></span></div>
                                            <div class="media-body">
                                                <h6 class="media-heading">Bret Lezama</h6>
                                                <p class="notification-text font-small-3 text-muted">I have seen your
                                                    work, there is</p><small>
                                                    <time class="media-meta text-muted"
                                                        datetime="2015-06-11T18:29:20+08:00">Tuesday</time></small>
                                            </div>
                                        </div>
                                    </a>
                                    <a href="javascript:void(0)">
                                        <div class="media">
                                            <div class="media-left"><span
                                                    class="avatar avatar-sm avatar-online rounded-circle"><img
                                                        src="/mil-doc/images/portrait/small/avatar-s-3.png"
                                                        alt="avatar"><i></i></span></div>
                                            <div class="media-body">
                                                <h6 class="media-heading">Carie Berra</h6>
                                                <p class="notification-text font-small-3 text-muted">Can we have call in
                                                    this week ?</p><small>
                                                    <time class="media-meta text-muted"
                                                        datetime="2015-06-11T18:29:20+08:00">Friday</time></small>
                                            </div>
                                        </div>
                                    </a>
                                    <a href="javascript:void(0)">
                                        <div class="media">
                                            <div class="media-left"><span
                                                    class="avatar avatar-sm avatar-away rounded-circle"><img
                                                        src="/mil-doc/images/portrait/small/avatar-s-6.png"
                                                        alt="avatar"><i></i></span></div>
                                            <div class="media-body">
                                                <h6 class="media-heading">Eric Alsobrook</h6>
                                                <p class="notification-text font-small-3 text-muted">We have project
                                                    party this saturday.</p><small>
                                                    <time class="media-meta text-muted"
                                                        datetime="2015-06-11T18:29:20+08:00">last month</time></small>
                                            </div>
                                        </div>
                                    </a>
                                </li>
                                <li class="dropdown-menu-footer"><a class="dropdown-item text-muted text-center"
                                        href="javascript:void(0)">Read all messages</a></li>
                            </ul>
                        </li>
                        <li class="dropdown dropdown-user nav-item">
                            <a class="dropdown-toggle nav-link dropdown-user-link" href="#" data-toggle="dropdown">
                                <span class="avatar avatar-online">
                                    <img src="/mil-doc/images/portrait/small/avatar-s-1.png" alt="avatar"><i></i>
                                </span>
                                <span class="user-name">พล.ท.สรรพงศ์ จันทเลิศ</span>
                            </a>
                            <div class="dropdown-menu dropdown-menu-right">
                                <a class="dropdown-item" href="user-profile.html"><i class="ft-user"></i>
                                    แก้ไขข้อมูลส่วนตัว</a>
                                <a class="dropdown-item" href="/mil-doc/pages/logout"><i class="ft-power"></i>
                                    ออกจากระบบ</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <div class="main-menu menu-fixed menu-dark menu-accordion menu-shadow" data-scroll-to-active="true">
        <div class="main-menu-content">
            <ul class="navigation navigation-main" id="main-menu-navigation" data-menu="menu-navigation">
                <li class="nav-item ">
                    <a href="/mil-doc/pages/main">
                        <i class="ft-home"></i>
                        <span class="menu-title" data-i18n="">หน้าแรก</span>
                    </a>
                </li>
                <li class="nav-item "><a href="#"><i class="ft-share"></i><span class="menu-title "
                            data-i18n="">หนังสือส่ง</span></a>
                    <ul class="menu-content">
                        <li class="active"><a class="menu-item" href="/mil-doc/documentsout/preparedoc.html"><i
                                    class="ft-chevrons-right"></i>สร้างเอกสารใหม่</a></li>
                    </ul>
                </li>

            </ul>
        </div>
    </div>


    <!-- ////////////////////////////////////////////////////////////////////////////-->
    <div class="app-content content" id="app">
        <div class='content-wrapper'>
            <div class='content-body'>
                <!-- Content -->

                <div class='row breadcrumbs-top pb-1'>
                    <div class='breadcrumb-wrapper col-12'>
                        <ol class='breadcrumb'>
                            <li class='breadcrumb-item'>หนังสือส่ง
                            </li>
                            <li class='breadcrumb-item active'>สร้างเอกสารใหม่
                            </li>
                        </ol>
                    </div>
                </div>


                <section id='verify_section' class='card' style='margin-bottom: 0.5rem;'>
                    <div class='card-header'>
                        <legend>สร้างเอกสารใหม่</legend>
                        <div class='heading-elements'>
                        </div>
                    </div>
                    <div class='card-content'>
                        <div class='card-body'>
                            <div class='card-text'>
                                <div class='row'>
                                    <div class='col-md-12 col-lg-12  col-sm-12 mt-1'>
                                        <h3 style="border-bottom:1px solid #BABFC7;">หนังสือ / Document</h3>
                                    </div>
                                    <div class='col-md-12 col-lg-4  col-sm-12 mt-1'>
                                        <label>เลขที่หนังสือ</label>
                                        <input type='text' v-model='bookNo' class='form-control'>
                                    </div>
                                    <div class='col-md-12 col-lg-4  col-sm-12 mt-1'>
                                        <label>ประเภท</label>
                                        <input type='text' v-model='bookType' value='' class='form-control'>
                                    </div>
                                    <div class='col-md-12 col-lg-4  col-sm-12 mt-1'>
                                        <label>ลงวันที่</label>
                                        <input type='date' min="2001-01-01" class='form-control' v-model="bookDate">
                                    </div>
                                    <div class='col-md-12 col-lg-6  col-sm-12 mt-1'>
                                        <label>เรื่อง</label>
                                        <input type='text' name='DocOutNo' class='form-control' v-model="bookSubject">
                                    </div>
                                    <div class='col-md-12 col-lg-3 col-sm-12 mt-1'>
                                        <label>ชั้นความเร็ว</label>
                                        <select class='form-control' v-model="bookSpeed">
                                            <option value='1'>ปกติ</option>
                                            <option value='2'>ด่วน</option>
                                            <option value='3'>ด่วนมาก</option>
                                            <option value='4'>ด่วนที่สุด</option>
                                        </select>
                                    </div>
                                    <div class='col-md-12 col-lg-3 col-sm-12 mt-1'>
                                        <label>ชั้นความลับ</label>
                                        <select class='form-control' v-model="bookSecret">
                                            <option value='1'>ปกติ</option>
                                            <option value='2'>ลับ</option>
                                            <option value='3'>ลับมาก</option>
                                            <option value='4'>ลับมากที่สุด</option>
                                        </select>
                                    </div>

                                    <div class='col-md-12 col-lg-6  col-sm-12 mt-1'>
                                        <label>รายละเอียด</label>
                                        <textarea class='form-control' v-model="bookDescription"></textarea>
                                    </div>
                                    <div class='col-md-12 col-lg-6  col-sm-12 mt-3'>
                                        <label>หนังสืออ้างอิง/Reference Correspondence &nbsp;</label>
                                        <button type=" button" class="btn btn-primary" data-toggle="modal"
                                            data-target="#refModal">
                                            <i class="ft-file-plus"></i>
                                        </button>

                                        <div class="col-md-12" v-for="(item, index) in refBooks">
                                            <p>
                                                <p>
                                                    <button class="btn btn-danger"
                                                        v-on:click=deleteRefBook(index)>ลบ</button>
                                                    <b>เลขที่หนังสือ</b>: {{  item.refBookNo }}
                                                    <b>ลงวันที่</b>: {{  item.refBookDate }}
                                                    <b>เรื่อง</b>: {{  item.refBookSubject }}
                                                </p>


                                            </p>

                                        </div>
                                    </div>
                                    <div class='col-md-12 offset-lg-6 col-lg-6  col-sm-12 mt-1'>
                                        <label>เอกสารหลัก / Main Attachment</label>
                                        <input type="file" v-on:change="addMainAttachment">
                                        <div class="col-md-12" v-for="(main, index) in mainAttachment">
                                            <p>
                                                <button class="btn btn-danger"
                                                    v-on:click=deleteMainAttachment(index)>ลบ</button>
                                                {{ main.name }}
                                            </p>

                                        </div>

                                    </div>
                                    <div class='col-md-12 offset-lg-6 col-lg-6  col-sm-12 mt-1'>
                                        <label>เอกสารแนบ / Other Attachment</label>
                                        <input type="file" @change="addOtherAttachment">
                                        <div class="col-md-12" v-for="(other, index) in otherAttachment">
                                            <p>
                                                <button class="btn btn-danger"
                                                    v-on:click=deleteOtherAttachment(index)>ลบ</button>
                                                {{ other.name }}
                                            </p>

                                        </div>
                                    </div>
                                    <hr>
                                    <br>
                                    <br>
                                    <div class='col-md-12 col-lg-12  col-sm-12 mt-5'>
                                        <h3 style="border-bottom:1px solid #BABFC7;">ผู้ส่งหนังสือ / Sender</h3>
                                    </div>
                                    <div class='col-md-12 col-lg-6  col-sm-12 mt-1'>
                                        <label>ตำแหน่ง</label>
                                        <input type='text' class='form-control' v-model='senderPostion'>
                                    </div>
                                    <div class='col-md-12 col-lg-6  col-sm-12 mt-1'>
                                        <label>ชื่อ</label>
                                        <input type='text' class='form-control' v-model='senderName'>
                                    </div>
                                    <div class='col-md-12 col-lg-6  col-sm-12 mt-1'>
                                        <label>นามสกุล</label>
                                        <input type='text' class='form-control' v-model='senderSurname'>
                                    </div>
                                    <div class='col-md-12 col-lg-6  col-sm-12 mt-1'>
                                        <label>หน่วยงานผู้ส่ง</label>
                                        <select class='form-control' name='SpeedID' v-model='senderDept'>
                                            <option value='1'>ปกติ</option>
                                            <option value='2'>ด่วน</option>
                                            <option value='3'>ด่วนมาก</option>
                                            <option value='4'>ด่วนที่สุด</option>
                                        </select>
                                    </div>


                                    <div class='col-md-12 col-lg-12  col-sm-12 mt-5'>
                                        <h3 style="border-bottom:1px solid #BABFC7;">ผู้รับหนังสือ / Receiver</h3>
                                    </div>
                                    <div class='col-md-12 col-lg-6  col-sm-12 mt-1'>
                                        <label>ตำแหน่ง</label>
                                        <input type='text' class='form-control' v-model='receiverPostion'>
                                    </div>
                                    <div class='col-md-12 col-lg-6  col-sm-12 mt-1'>
                                        <label>ชื่อ</label>
                                        <input type='text' class='form-control' v-model='receiverName'>
                                    </div>
                                    <div class='col-md-12 col-lg-6  col-sm-12 mt-1'>
                                        <label>นามสกุล</label>
                                        <input type='text' class='form-control' v-model='receiverSurname'>
                                    </div>
                                    <div class='col-md-12 col-lg-6  col-sm-12 mt-1'>
                                        <label>หน่วยงานผู้ส่ง</label>
                                        <select class='form-control' v-model='receiverDept'>
                                            <option v-for="organization in organizations" :value="organization.URL">
                                                {{ organization.Name }}
                                            </option>
                                        </select>
                                    </div>
                                    <div class='col-12 text-center pt-1'>
                                        <button type='button' class='btn btn-primary' v-on:click="requestSendDoc">
                                            <i class='fa fa-save'></i>&nbsp;บันทึก
                                        </button>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </section>
            </div>
        </div>
        <div class="modal" tabindex="-1" role="dialog" id="refModal">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header" style="border-bottom: 0px;">
                        <h5 class="modal-title">Modal title</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"
                            v-on:click="resetReference">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class='col-md-12 col-lg-12  col-sm-12 mt-1'>
                                <label>เลขที่หนังสืออ้างอิง</label>
                                <input type='text' class='form-control' v-model="refBookNo">
                            </div>
                            <div class='col-md-12 col-lg-12 col-sm-12 mt-1'>
                                <label>ลงวันที่หนังสืออ้างอิง</label>
                                <input type='date' class='form-control' v-model="refBookDate">
                            </div>
                            <div class='col-md-12 col-lg-12 col-sm-12 mt-1'>
                                <label>เรื่องหนังสืออ้างอิง</label>
                                <input type='text' class='form-control' v-model="refBookSubject">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer" style="border-top: 0px;">
                        <button type="button" class="btn btn-primary" v-on:click=addReference>เพิ่ม</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal"
                            v-on:click=resetReference>ปิด</button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- ////////////////////////////////////////////////////////////////////////////-->


    <script src="/mil-doc/vendors/js/vendors.min.js"></script>
    <script src="/mil-doc/js/core/app-menu.js"></script>
    <script src="/mil-doc/js/core/app.js"></script>
    <script src="/mil-doc/vendors/js/forms/validation/jquery.validate.min.js"></script>
    <script>
        var n = Date.now();
        function formatDate(date) {
            var d = new Date(date),
                month = '' + (d.getMonth() + 1),
                day = '' + d.getDate(),
                year = d.getFullYear();

            if (month.length < 2)
                month = '0' + month;
            if (day.length < 2)
                day = '0' + day;

            return [year, month, day].join('-');
        }


        var app = new Vue({
            el: '#app',
            data: {
                bookNo: '',
                bookType: '',
                bookDate: formatDate(n),
                bookSubject: '',
                bookSpeed: 2,
                bookSecret: 1,
                bookDescription: '',
                refBookNo: '',
                refBookDate: '',
                refBookSubject: '',
                refBooks: [],
                mainAttachment: [],
                otherAttachment: [],
                senderPostion: '',
                senderName: '',
                senderSurname: '',
                senderDept: '',
                receiverPostion: '',
                receiverName: '',
                receiverSurname: '',
                receiverDept: '1',
                organizations: []
            },
            methods: {
                addMainAttachment(event) {
                    if (event.target.files[0] != null) {
                        if (this.mainAttachment.length > 0) {
                            this.mainAttachment.splice(0, 1);
                            this.mainAttachment.push(event.target.files[0])
                        }
                        else {
                            this.mainAttachment.push(event.target.files[0])
                        }

                        console.log(this.mainAttachment);
                    }

                },
                addOtherAttachment(event) {
                    if (event.target.files[0] != null) {
                        this.otherAttachment.push(event.target.files[0])
                        console.log(this.otherAttachment);
                    }

                },
                deleteOtherAttachment(index) {
                    this.otherAttachment.splice(index, 1)
                },
                deleteMainAttachment(index) {
                    this.mainAttachment.splice(index, 1)
                },
                addReference() {
                    var object = {
                        refBookNo: this.refBookNo,
                        refBookDate: this.refBookDate,
                        refBookSubject: this.refBookSubject
                    }
                    this.refBooks.push(object);
                    this.refBookNo = ''
                    this.refBookDate = ''
                    this.refBookSubject = ''
                    $('#refModal').modal('toggle');
                },
                resetReference() {

                    this.refBookNo = ''
                    this.refBookDate = ''
                    this.refBookSubject = ''
                },
                deleteRefBook(index) {
                    this.refBooks.splice(index, 1)
                },
                saveDocument() {

                },

                requestSendDoc() {

                    let formData = new FormData();
                    for (i = 0; i < this.otherAttachment.length; i++) {
                        formData.append("file", this.otherAttachment[i]);
                    }

                    $.ajax({
                        type: 'POST',
                        url: "http://localhost:51618/service/AddDocument",
                        data: {
                            doc: {
                                "No": this.bookno,
                                "Type": this.bookType,
                                "Date": this.bookDate,
                                "Subject": this.bookSubject,
                                "Speed": this.bookSpeed,
                                "Secret": this.bookSecret,
                                "Description": this.bookDescription,
                                "MainAttachmentName": this.mainAttachment.length > 0 ? this.mainAttachment[0].name : null,
                                "SenderPosition": this.senderPostion,
                                "SenderName": this.senderName,
                                "SenderSurname": this.senderSurname,
                                "SenderDept": this.senderDept,
                                "ReceiverPosition": this.receiverPostion,
                                "ReceiverName": this.receiverName,
                                "ReceiverSurname": this.receiverSurnamed,
                                "ReceiverDept": this.receiverDept,
                                "Status": "บันทึกรอส่ง",
                                "From": "scp1"
                            }
                        },
                        // data: formData,
                        dataType: 'json',
                        // contentType: false,
                        //processData: false,
                        success: function (response) {

                            formData.append("ID", response.ResponseObject.Id)
                            
                            $.ajax({
                                type: 'POST',
                                url: "http://localhost:51618/service/AddDocument2",
                                data: formData,
                                contentType: false,
                                processData: false,
                                success: function (resultData) {
                                    console.log(resultData)
                                }
                            })

                        },
                        error: function (xhr, textStatus, error) {
                            console.log(xhr.statusText);
                            console.log(textStatus);
                            console.log(error);
                        }
                    });
                }

            }, created() {

            }, mounted() {
                axios
                    .get('http://localhost:51618/api/RequestOrganizationList')
                    .then(response => this.organizations = response.data)
                    .then(console.log(this.organizations))


            },
        })

    </script>


</body>

</html>